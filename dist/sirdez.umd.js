(function(o,y){typeof exports=="object"&&typeof module!="undefined"?y(exports):typeof define=="function"&&define.amd?define(["exports"],y):(o=typeof globalThis!="undefined"?globalThis:o||self,y(o.sirdez={}))})(this,function(o){"use strict";function y(n=4096){const e=new ArrayBuffer(n);return{i:0,view:new DataView(e),bytes:new Uint8Array(e)}}function w(n){n.bytes=new Uint8Array(n.bytes.length*2),n.view=new DataView(n.bytes.buffer)}function f(n,e,t){for(;;){const i=n.bytes.length-8;n.i=0;try{if(e(n,t),n.i<i)return}catch(s){if(n.i<i)throw s}w(n)}}async function g(n,e,t){for(;;){const i=n.bytes.length-8;n.i=0;try{if(await e(n,t),n.i<i)return}catch(s){if(n.i<i)throw s}w(n)}}function U(n,e,t){const{length:i}=t;return i<4096?(n.bytes.set(t),n.i=0,e(n)):e(b(t))}function b(n){return{i:0,bytes:n,view:new DataView(n.buffer,n.byteOffset,n.byteLength)}}function v(n,e){const t=y();return{ser:n,des:e,async toBytes(i){return await g(t,n,i),t.bytes.slice(0,t.i)},async toTempBytes(i){return await g(t,n,i),t.bytes.subarray(0,t.i)},fromBytes(i){return e(b(i))}}}function c(n,e){const t=y();return{ser:n,des:e,toBytes(i){return f(t,n,i),t.bytes.slice(0,t.i)},toTempBytes(i){return f(t,n,i),t.bytes.subarray(0,t.i)},fromBytes(i){return U(t,e,i)}}}const L={encode(n,e){const{length:t}=e;for(let i=0;i<t;i++)n.view.setUint8(n.i++,e.charCodeAt(i))},decode(n,e){return String.fromCharCode.apply(null,n.bytes.subarray(n.i,n.i=e))}},P={encode(n,e){const{length:t}=e;for(let i=0;i<t;i++)n.view.setUint16(n.i,e.charCodeAt(i)),n.i+=2},decode(n,e){const t=[];for(;n.i<e;)t.push(n.view.getUint16(n.i)),n.i+=2;return String.fromCharCode.apply(null,t)}},V=new TextEncoder,z=new TextDecoder,M={encode(n,e){n.i+=V.encodeInto(e,n.bytes.subarray(n.i)).written},decode(n,e){return z.decode(n.bytes.subarray(n.i,n.i=e))}},R={encode(n,e){const{length:t}=e;for(let i=0;i<t;i++){const s=e.charCodeAt(i);if(s<128)n.view.setUint8(n.i,s),n.i++;else if(s<2048){const a=(s&1984)<<2,r=s&63;n.view.setUint16(n.i,a|r|49280),n.i+=2}else if(s<55296||s>=57344){const a=(s&61440)<<12,r=(s&4032)<<10,u=(s&63)<<8;n.view.setUint32(n.i,a|r|u|3766517760),n.i+=3}else{const a=e.codePointAt(i++),r=(a&1835008)<<6,u=(a&258048)<<4,d=(a&4032)<<2,wn=a&63;n.view.setUint32(n.i,r|u|d|wn|4034953344),n.i+=4}}},decode(n,e){const t=[];for(;n.i<e;){const i=n.view.getUint8(n.i);if(i<192)t.push(i),n.i++;else if(i<224){const s=n.view.getUint8(n.i+1);n.i+=2,t.push((i&31)<<6|s&63)}else if(i<240){const s=n.view.getUint8(n.i+1),a=n.view.getUint8(n.i+2);n.i+=3,t.push((i&15)<<12|(s&63)<<6|a&63)}else{const s=n.view.getUint32(n.i),a=(i&7)<<18,r=(s&4128768)>>4,u=(s&16128)>>2,d=s&63;t.push(a|r|u|d),n.i+=4}}return String.fromCodePoint.apply(null,t)}},_=(n,e)=>c((t,i)=>{const{length:s}=i;e.ser(t,s);for(let a=0;a<s;a++)n.ser(t,i[a])},t=>{const i=e.des(t),s=[];for(let a=0;a<i;a++)s.push(n.des(t));return s}),h=c((n,e)=>n.view.setUint8(n.i++,e),n=>n.view.getUint8(n.i++)),m=c((n,e)=>{n.view.setUint16(n.i,e),n.i+=2},n=>{const e=n.view.getUint16(n.i);return n.i+=2,e}),I=c((n,e)=>{n.view.setUint32(n.i,e),n.i+=4},n=>{const e=n.view.getUint32(n.i);return n.i+=4,e}),$=c((n,e)=>{n.view.setBigUint64(n.i,e),n.i+=8},n=>{const e=n.view.getBigUint64(n.i);return n.i+=8,e}),B=c((n,e)=>n.view.setInt8(n.i++,e),n=>n.view.getInt8(n.i++)),j=c((n,e)=>{n.view.setInt16(n.i,e),n.i+=2},n=>{const e=n.view.getInt16(n.i);return n.i+=2,e}),C=c((n,e)=>{n.view.setInt32(n.i,e),n.i+=4},n=>{const e=n.view.getInt32(n.i);return n.i+=4,e}),T=c((n,e)=>{n.view.setBigInt64(n.i,e),n.i+=8},n=>{const e=n.view.getBigInt64(n.i);return n.i+=8,e}),A=c((n,e)=>{n.view.setFloat32(n.i,e),n.i+=4},n=>{const e=n.view.getFloat32(n.i);return n.i+=4,e}),F=c((n,e)=>{n.view.setFloat64(n.i,e),n.i+=8},n=>{const e=n.view.getFloat64(n.i);return n.i+=8,e}),J={uint8:h,uint16:m,uint32:I,int8:B,int16:j,int32:C,float32:A,float64:F,bigUint64:$,bigInt64:T},q=(n,e)=>J[`${n}${e}`],G=n=>c((e,t)=>{t==null?e.view.setUint8(e.i++,0):(e.view.setUint8(e.i++,1),n.ser(e,t))},e=>e.view.getUint8(e.i++)?n.des(e):void 0),H=(n,e,t)=>c((i,s)=>{const{length:a}=Object.keys(s);e.ser(i,a);for(const r in s)t.ser(i,r),n.ser(i,s[r])},i=>{const s=e.des(i),a={};for(let r=0;r<s;r++)a[t.des(i)]=n.des(i);return a}),K=(n,e)=>c((t,i)=>{const s=t.i;e.ser(t,0);const a=t.i;n.encode(t,i);const r=t.i,u=r-a;t.i=s,e.ser(t,u),t.i=r},t=>n.decode(t,e.des(t)+t.i)),O=n=>{const e=n instanceof Array?()=>[]:()=>({});return c((t,i)=>{for(const s in n)n[s].ser(t,i[s])},t=>{const i=e();for(const s in n)i[s]=n[s].des(t);return i})},Q=(...n)=>O(n),W=n=>c((e,t)=>{const{byteLength:i}=t;n.ser(e,i),e.bytes.set(t,e.i),e.i+=i},e=>{const t=n.des(e);return e.bytes.subarray(e.i,e.i+=t)}),X=c((n,e)=>void n.view.setUint8(n.i++,+e),n=>!!n.view.getUint8(n.i++)),D=n=>isNaN(+n)?JSON.stringify(n):n;function S(n,e){const t=e?"async ":"",i=e?"await ":"",s=Object.keys(n),a=Object.keys(s).map(u=>+u),r=Object.values(n);return new Function("d",`[${a.map(u=>"k"+u).join()}]`,`[${a.map(u=>"s"+u).join()}]`,`[${a.map(u=>"d"+u).join()}]`,`return d(${t}(c,d)=>{${a.map(u=>`${i}s${u}(c,d[${D(s[u])}])`).join(";")}},${t}(c)=>{const d=${n instanceof Array?"[]":"{}"};${a.map(u=>`d[${D(s[u])}]=${i}d${u}(c)`).join(";")};return d})`)(c,s,r.map(({ser:u})=>u),r.map(({des:u})=>u))}const k=n=>S(n,!1),Y=(...n)=>k(n),l=(n,e)=>{const t=n[0].toUpperCase()+n.slice(1)+e,i=e/8;return new Function("d",`return d((c,d)=>{c.view.set${t}(c.i,d);c.i+=${i}},(c)=>{const d=c.view.get${t}(c.i);c.i+=${i};return d})`)(c)},Z=l("uint",8),p=l("uint",16),x=l("uint",32),nn=l("int",8),en=l("int",16),tn=l("int",32),sn=l("bigUint",64),on=l("bigInt",64),an=l("float",32),rn=l("float",64),un=(n,e)=>v(async(t,i)=>{const{length:s}=i;e.ser(t,s);for(let a=0;a<s;a++)await n.ser(t,i[a])},async t=>{const i=e.des(t),s=[];for(let a=0;a<i;a++)s.push(await n.des(t));return s}),E=n=>S(n,!0),cn=(...n)=>E(n),ln=n=>v(async(e,t)=>{t==null?e.view.setUint8(e.i++,0):(e.view.setUint8(e.i++,1),await n.ser(e,t))},async e=>e.view.getUint8(e.i++)?await n.des(e):void 0),yn=(n,e,t)=>v(async(i,s)=>{const{length:a}=Object.keys(s);e.ser(i,a);for(const r in s)t.ser(i,r),await n.ser(i,s[r])},async i=>{const s=e.des(i),a={};for(let r=0;r<s;r++)a[t.des(i)]=await n.des(i);return a}),N=n=>{const e=n instanceof Array?()=>[]:()=>({});return v(async(t,i)=>{for(const s in n)await n[s].ser(t,i[s])},async t=>{const i=e();for(const s in n)i[s]=await n[s].des(t);return i})},vn=(...n)=>N(n);o.array=_,o.ascii=L,o.asyncArray=un,o.asyncContextSer=g,o.asyncDefine=v,o.asyncEvalStruct=E,o.asyncEvalTuple=cn,o.asyncOptional=ln,o.asyncRecord=yn,o.asyncStruct=N,o.asyncTuple=vn,o.bigInt64=T,o.bigUint64=$,o.boolean=X,o.bytes=W,o.contextDes=U,o.contextFromBytes=b,o.contextSer=f,o.createContext=y,o.define=c,o.evalBigInt64=on,o.evalBigUint64=sn,o.evalFloat32=an,o.evalFloat64=rn,o.evalInt16=en,o.evalInt32=tn,o.evalInt8=nn,o.evalNumber=l,o.evalStruct=k,o.evalTuple=Y,o.evalUint16=p,o.evalUint32=x,o.evalUint8=Z,o.float32=A,o.float64=F,o.growContext=w,o.int16=j,o.int32=C,o.int8=B,o.number=q,o.optional=G,o.record=H,o.string=K,o.struct=O,o.tuple=Q,o.uint16=m,o.uint32=I,o.uint8=h,o.utf16=P,o.utf8=M,o.utf8js=R,Object.defineProperty(o,"__esModule",{value:!0}),o[Symbol.toStringTag]="Module"});
